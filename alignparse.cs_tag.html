
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>cs_tag &#8212; alignparse 0.6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="minimap2" href="alignparse.minimap2.html" />
    <link rel="prev" title="constants" href="alignparse.constants.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-alignparse.cs_tag"></span><section id="cs-tag">
<h1>cs_tag<a class="headerlink" href="#cs-tag" title="Permalink to this headline">¶</a></h1>
<p>Parse SAM entries with <code class="docutils literal notranslate"><span class="pre">cs</span></code> short tag from
<a class="reference external" href="https://lh3.github.io/minimap2/">minimap2</a> output.</p>
<p>See <a class="reference external" href="https://lh3.github.io/minimap2/minimap2.html">here</a> for details on
short <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag format.</p>
<dl class="py class">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">Alignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sam_alignment</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">introns_to_deletions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#Alignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.Alignment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Process a SAM alignment with a <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag to extract features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sam_alignment</strong> (<em>pysam.AlignedSegment</em>) – Aligned segment from <a class="reference external" href="https://pysam.readthedocs.io">pysam</a>,
must have a short format <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag (see
<a class="reference external" href="https://lh3.github.io/minimap2/minimap2.html">https://lh3.github.io/minimap2/minimap2.html</a>). This must be
a mapped read, you will get an error if unmapped.</p></li>
<li><p><strong>introns_to_deletions</strong> (<em>bool</em>) – Convert all introns in the <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag to deletions.</p></li>
<li><p><strong>target_seqs</strong> (<em>dict</em>) – Required if <cite>introns_to_deletions</cite> is <cite>True</cite>. Is keyed by target
names with values target sequences as str.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.query_name">
<span class="sig-name descname"><span class="pre">query_name</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.query_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of query in alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.target_name">
<span class="sig-name descname"><span class="pre">target_name</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.target_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of alignment target.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.cs">
<span class="sig-name descname"><span class="pre">cs</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.cs" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.query_clip5">
<span class="sig-name descname"><span class="pre">query_clip5</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.query_clip5" title="Permalink to this definition">¶</a></dt>
<dd><p>Length at 5’ end of query not in alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.query_clip3">
<span class="sig-name descname"><span class="pre">query_clip3</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.query_clip3" title="Permalink to this definition">¶</a></dt>
<dd><p>Length at 3’ end of query not in alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.target_clip5">
<span class="sig-name descname"><span class="pre">target_clip5</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.target_clip5" title="Permalink to this definition">¶</a></dt>
<dd><p>Length at 5’ end of target not in alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.target_lastpos">
<span class="sig-name descname"><span class="pre">target_lastpos</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.target_lastpos" title="Permalink to this definition">¶</a></dt>
<dd><p>Last position of alignment in target (exclusive).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.orientation">
<span class="sig-name descname"><span class="pre">orientation</span></span><a class="headerlink" href="#alignparse.cs_tag.Alignment.orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Does query align to the target (+) or reverse complement (-).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>{‘+’, ‘-‘}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.extract_cs">
<span class="sig-name descname"><span class="pre">extract_cs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#Alignment.extract_cs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.Alignment.extract_cs" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag corresponding to feature in target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – Start of feature in target in 0, 1, … numbering.</p></li>
<li><p><strong>end</strong> (<em>int</em>) – End of feature in target (not inclusive of this site).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If feature is not present in alignment, return <cite>None</cite>. Otherwise,
return <cite>(cs, clip5, clip3)</cite> where <cite>cs</cite> is the <code class="docutils literal notranslate"><span class="pre">cs</span></code> string for
the aligned portion of the feature, and <cite>clip5</cite> and <cite>clip3</cite> are
the lengths that must be clipped off the end of the feature to
get to that alignment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an insertion is at the boundary of two features, it is assigned
as being at the end of the first feature.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alignparse.cs_tag.Alignment.get_accuracy">
<span class="sig-name descname"><span class="pre">get_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targetstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetend</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#Alignment.get_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.Alignment.get_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get accuracy of part of query aligned to a region of the target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targetstart</strong> (<em>int</em>) – Start of region in target in 0, 1, … numbering.</p></li>
<li><p><strong>targetend</strong> (<em>int</em>) – End of region in target (not inclusive of this site).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The accuracy of the region, computed as the average of the
Q-scores for all aligned sites in the query, or <cite>NaN</cite> if
there are no query sites aligned to this region.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or NaN</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_introns_to_deletions">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_introns_to_deletions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetseq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_introns_to_deletions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_introns_to_deletions" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert introns to deletions in <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs</strong> (<em>str</em>) – Short-format <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p></li>
<li><p><strong>targetseq</strong> (<em>str</em>) – Region of target sequenced covered by <cite>cs</cite> alignment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Version of <cite>cs</cite> where all introns have been converted to deletions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_introns_to_deletions</span><span class="p">(</span><span class="s1">&#39;:3-ggaac:2&#39;</span><span class="p">,</span> <span class="s1">&#39;ATGGGAACAT&#39;</span><span class="p">)</span>
<span class="go">&#39;:3-ggaac:2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_introns_to_deletions</span><span class="p">(</span><span class="s1">&#39;:3~gg5ac:2&#39;</span><span class="p">,</span> <span class="s1">&#39;ATGGGAACAT&#39;</span><span class="p">)</span>
<span class="go">&#39;:3-ggaac:2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_introns_to_deletions</span><span class="p">(</span><span class="s1">&#39;:2*ga~gg6ta:2-gc:2~at4cg:3&#39;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="s1">&#39;ATGGGCCTATTGCTAATCGAAA&#39;</span><span class="p">)</span>
<span class="go">&#39;:2*ga-ggccta:2-gc:2-atcg:3&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_op_len_target">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_op_len_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs_op</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_op_len_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_op_len_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Get length of valid <code class="docutils literal notranslate"><span class="pre">cs</span></code> operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs_op</strong> (<em>str</em>) – A <strong>single</strong> operation in a short <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p></li>
<li><p><strong>invalid</strong> (<em>{'raise'</em><em>, </em><em>'ignore'}</em>) – If <cite>cs_string</cite> is not a valid string, raise an error or ignore it
and return <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Length of given cs_op. This length is based on the target sequence,
so insertions in the query have length 0 and deletions are the length
of the target sequence deleted from the query. ‘None’ if <cite>cs_op</cite>
is invalid and <cite>invalid</cite> is <cite>ignore</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;*nt&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;:45&#39;</span><span class="p">)</span>
<span class="go">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;-at&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;+gc&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;*nt:45&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">invalid `cs_op` of *nt:45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_len_target</span><span class="p">(</span><span class="s1">&#39;*nt:45&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_op_type">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_op_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs_op</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_op_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_op_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get type of <code class="docutils literal notranslate"><span class="pre">cs</span></code> operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs_op</strong> (<em>str</em>) – A <strong>single</strong> operation in a short <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p></li>
<li><p><strong>invalid</strong> (<em>{'raise'</em><em>, </em><em>'ignore'}</em>) – If <cite>cs_string</cite> is not a valid string, raise an error or ignore it
and return <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Type of <code class="docutils literal notranslate"><span class="pre">cs</span></code> operation, or <cite>None</cite> if <cite>cs_string</cite> invalid and
<cite>invalid</cite> is ‘ignore’.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>{‘substitution’, ‘insertion’, ‘deletion’, ‘identity’, None}</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_type</span><span class="p">(</span><span class="s1">&#39;*nt&#39;</span><span class="p">)</span>
<span class="go">&#39;substitution&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_type</span><span class="p">(</span><span class="s1">&#39;:45&#39;</span><span class="p">)</span>
<span class="go">&#39;identity&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_type</span><span class="p">(</span><span class="s1">&#39;*nt:45&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">invalid `cs_op` of *nt:45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_op_type</span><span class="p">(</span><span class="s1">&#39;*nt:45&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_to_mutation_str">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_to_mutation_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_to_mutation_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_to_mutation_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag to a descriptive string of mutations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs</strong> (<em>str</em>) – A <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – Mutations are numbered in 1, … numbering <strong>plus</strong> this offset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Space-delimited string of form ‘A5T G86A ins7ACG del19to24’
for all mutations specified in <cite>cs</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_mutation_str</span><span class="p">(</span><span class="s1">&#39;:4*nt-tc:2+ga:6&#39;</span><span class="p">)</span>
<span class="go">&#39;del6to7 ins10GA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_mutation_str</span><span class="p">(</span><span class="s1">&#39;:4*at-tc:2+ga:6&#39;</span><span class="p">)</span>
<span class="go">&#39;A5T del6to7 ins10GA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_mutation_str</span><span class="p">(</span><span class="s1">&#39;:4*at-tc:2+ga:6&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;A7T del8to9 ins12GA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_mutation_str</span><span class="p">(</span><span class="s1">&#39;:45&#39;</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mutation strings use “human readable” indexing, so the first nucleotide of
the sequence is 1 and deletions are inclusive of the last number.</p>
<p>Changes from ambiguous nucleotides to any other identity are <strong>not</strong>
considered mutations in the returned strings.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_to_nt_mutation_count">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_to_nt_mutation_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_to_nt_mutation_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_to_nt_mutation_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of nucleotide mutations in <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cs</strong> (<em>str</em>) – <cite>cs</cite> string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of nucleotides that are mutated. Insertions / deletions
are counted as the number of nucleotides in the indel.
Changes from an ambiguous nucleotide to are <strong>not</strong> considered
mutations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_nt_mutation_count</span><span class="p">(</span><span class="s1">&#39;:4*nt-tc:2+g&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_nt_mutation_count</span><span class="p">(</span><span class="s1">&#39;:4*gt-tc:2+g&#39;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_to_op_mutation_count">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_to_op_mutation_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_to_op_mutation_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_to_op_mutation_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of mutation operations in <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cs</strong> (<em>str</em>) – The <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of mutation operations in the query sequence. Each indel or
substitution is counted as a single mutation operation regardless
of how many mutations it contains. Changes from ambiguous nucleotides
to another nucleotide are <strong>not</strong> counted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_op_mutation_count</span><span class="p">(</span><span class="s1">&#39;:4*nt-tc:2+g&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_op_mutation_count</span><span class="p">(</span><span class="s1">&#39;:4*gt-tc:2+g&#39;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.cs_to_sequence">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">cs_to_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#cs_to_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.cs_to_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag to a sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs</strong> (<em>str</em>) – <cite>cs</cite> string</p></li>
<li><p><strong>seq</strong> (<em>str</em>) – Sequence of target for region corresponding to <cite>cs</cite> string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nucleotide sequence generated by applying <cite>cs</cite> to <cite>seq</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs_to_sequence</span><span class="p">(</span><span class="s1">&#39;:4*nt-tc:2+g:2&#39;</span><span class="p">,</span> <span class="s1">&#39;CGGANTCCAAT&#39;</span><span class="p">)</span>
<span class="go">&#39;CGGATCAGAT&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alignparse.cs_tag.split_cs">
<span class="sig-prename descclassname"><span class="pre">alignparse.cs_tag.</span></span><span class="sig-name descname"><span class="pre">split_cs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cs_string</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_intron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alignparse/cs_tag.html#split_cs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alignparse.cs_tag.split_cs" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a short <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag into its constituent operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs_string</strong> (<em>str</em>) – The short <code class="docutils literal notranslate"><span class="pre">cs</span></code> tag.</p></li>
<li><p><strong>invalid</strong> (<em>{'raise'</em><em>, </em><em>'ignore'}</em>) – If <cite>cs_string</cite> is not a valid string, raise an error or ignore it
and return <cite>None</cite>.</p></li>
<li><p><strong>allow_intron</strong> (<em>bool</em>) – Are introns allowed as <code class="docutils literal notranslate"><span class="pre">cs</span></code> operations?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of the individual <code class="docutils literal notranslate"><span class="pre">cs</span></code> operations, or <cite>None</cite> if invalid
<cite>cs_string</cite> and <cite>invalid</cite> is ‘ignore’.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_cs</span><span class="p">(</span><span class="s1">&#39;:32*nt*na:10-gga:5+aaa:10&#39;</span><span class="p">)</span>
<span class="go">(&#39;:32&#39;, &#39;*nt&#39;, &#39;*na&#39;, &#39;:10&#39;, &#39;-gga&#39;, &#39;:5&#39;, &#39;+aaa&#39;, &#39;:10&#39;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_cs</span><span class="p">(</span><span class="s1">&#39;bad:32*nt*na:10-gga:5&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_cs</span><span class="p">(</span><span class="s1">&#39;bad:32*nt*na:10-gga:5&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">invalid `cs_string` of bad:32*nt*na:10-gga:5</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">alignparse</h1>
    
  </a>
</p>



<p class="blurb">Align sequences and then parse features.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=alignparse&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jbloomlab/alignparse">
    <img
        alt="https://secure.travis-ci.org/jbloomlab/alignparse.svg?branch=master"
        src="https://secure.travis-ci.org/jbloomlab/alignparse.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">alignparse documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="alignparse.html">alignparse package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alignparse.html#alignparse">alignparse</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="alignparse.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">Package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="alignparse.html">alignparse package</a><ul>
      <li>Previous: <a href="alignparse.constants.html" title="previous chapter">constants</a></li>
      <li>Next: <a href="alignparse.minimap2.html" title="next chapter">minimap2</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2023.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/alignparse.cs_tag.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/alignparse" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>